# System Patterns

## システムの構築方法 (How the system is built)

*   **サーバーサイド (Python/Flask):** Python と Flask を使用。HTTPリクエストを受け付け、ビジネスロジックを実行し、データベース (SQLite) と連携する。主に **API エンドポイント**を提供し、データ (JSON 形式など) やシンプルな HTML フラグメントを返す役割を担う。初期の静的な HTML (`index.html`) の配信も行うが、**Jinja2 による動的コンテンツ生成は原則行わない**。
*   **フロントエンド (ブラウザ):** 最初に静的な HTML (`index.html`), CSS (`static/style.css`), JavaScript (`static/htmx.min.js`, Vanilla JS) を読み込む。**htmx** を使用して、ページの読み込み時やユーザー操作時にサーバーサイドの API エンドポイントにリクエストを送信する。サーバーから受け取ったデータや HTML フラグメントをもとに、htmx または Vanilla JS を使って動的に DOM を構築・更新する。
*   **データ永続化:** Python 標準の `sqlite3` モジュールを使用し、SQLite データベースにメモの状態 (ID, 内容, 位置) を保存する。データベース操作はすべてサーバーサイド (Flask) の API エンドポイント経由で行う。

## 主要な技術的決定 (Key technical decisions)

*   **htmx の採用:** JavaScriptの記述量を最小限に抑え、サーバーサイドでHTMLを生成・配信するアプローチを採用することで、vibeコーディング（迅速なプロトタイピングとイテレーション）に適した開発スタイルを目指す。
*   **Vanilla JS:** フロントエンドのロジックが必要な場合に限り、最小限の Vanilla JS を使用する。大規模なフロントエンドフレームワークは導入しない。
*   **Python/Flask サーバー:** ユーザー指示に基づき採用。Python のエコシステムを活用し、`sqlite3` 標準ライブラリでデータベースアクセスが容易。
*   **SQLite:** セットアップが簡単でファイルベースであるため、シンプルな構成という要件に合致する。Python 標準ライブラリでサポートされている。

## アーキテクチャパターン (Architecture patterns)

*   **API駆動型 + htmx:** サーバーは主にデータを提供する API として機能し、フロントエンドは htmx を使ってそのデータを取得し、UI を動的に更新するアプローチを採用。サーバーから HTML フラグメントを返す場合もあるが、初期描画は静的 HTML + htmx によるデータ取得が中心となる。
*   **明確な役割分担:**
    *   **サーバー (Python/Flask):** データ処理、ビジネスロジック、データ/HTMLフラグメント提供 API。
    *   **クライアント (ブラウザ):** 静的 UI 構造表示、htmx/JS による API 通信、データに基づいた DOM 操作と更新。
*   **シンプルなデータモデル:** SQLiteに保存するデータ構造は、メモのID、内容、位置（x, y座標）など、必要最小限の情報に留める。
